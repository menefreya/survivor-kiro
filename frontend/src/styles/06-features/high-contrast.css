/**
 * High Contrast Mode Support
 * 
 * This file provides enhanced accessibility support for users who prefer
 * high contrast interfaces, including system high contrast mode and
 * forced colors mode (Windows High Contrast).
 */

/* ============================================
   HIGH CONTRAST MODE DETECTION & SUPPORT
   ============================================ */

/* Enhanced high contrast mode for users who prefer higher contrast */
@media (prefers-contrast: high) {
  :root {
    /* Enhanced contrast color tokens */
    --hc-text-primary: #FFFFFF;
    --hc-text-secondary: #F0F0F0;
    --hc-text-tertiary: #E0E0E0;
    --hc-bg-primary: #000000;
    --hc-bg-secondary: #1A1A1A;
    --hc-bg-tertiary: #2A2A2A;
    --hc-border-primary: #FFFFFF;
    --hc-border-secondary: #CCCCCC;
    --hc-border-width: 2px;
    --hc-outline-width: 4px;
    
    /* Override existing tokens for higher contrast */
    --color-text-primary: var(--hc-text-primary);
    --color-text-secondary: var(--hc-text-secondary);
    --color-text-tertiary: var(--hc-text-tertiary);
    --color-bg-primary: var(--hc-bg-primary);
    --color-bg-secondary: var(--hc-bg-secondary);
    --color-bg-tertiary: var(--hc-bg-tertiary);
    
    /* Enhanced border visibility */
    --color-border-subtle: var(--hc-border-secondary);
    --color-border-medium: var(--hc-border-primary);
    --color-border-strong: var(--hc-border-primary);
    
    /* Enhanced focus indicators */
    --focus-outline-width: var(--hc-outline-width);
    --focus-ring-primary: 0 0 0 var(--hc-outline-width) var(--color-primary);
    
    /* Remove subtle effects that may reduce contrast */
    --shadow-card: 0 0 0 var(--hc-border-width) var(--hc-border-primary);
    --shadow-card-hover: 0 0 0 var(--hc-border-width) var(--color-primary);
    --text-shadow-glow: none;
    --text-shadow-subtle: none;
    --text-shadow-dramatic: none;
    --text-shadow-hero: none;
    
    /* Simplify gradients to solid colors */
    --gradient-primary: var(--color-primary);
    --gradient-primary-hover: var(--color-primary-hover);
    --gradient-secondary: var(--color-secondary);
    --gradient-success: var(--color-success);
    --gradient-warning: var(--color-warning);
    --gradient-danger: var(--color-danger);
  }
  
  /* ============================================
     ENHANCED COMPONENT CONTRAST
     ============================================ */
  
  /* Base elements */
  body {
    background-color: var(--hc-bg-primary);
    color: var(--hc-text-primary);
  }
  
  /* Headings */
  h1, h2, h3, h4, h5, h6 {
    color: var(--hc-text-primary);
    text-shadow: none;
  }
  
  /* Links */
  a {
    color: var(--color-primary);
    text-decoration: underline;
    text-decoration-thickness: 2px;
    text-underline-offset: 4px;
  }
  
  a:hover {
    background-color: var(--color-primary);
    color: var(--hc-bg-primary);
    text-decoration: none;
    padding: 2px 4px;
    border-radius: 2px;
  }
  
  /* Cards and containers */
  .card,
  .modal,
  .dropdown,
  .tooltip {
    background-color: var(--hc-bg-secondary);
    border: var(--hc-border-width) solid var(--hc-border-primary);
    box-shadow: none;
  }
  
  /* Removed card hover effects for high contrast mode */
  
  /* Buttons */
  .btn {
    border: var(--hc-border-width) solid var(--hc-border-primary);
    box-shadow: none;
    text-shadow: none;
  }
  
  .btn-primary {
    background-color: var(--color-primary);
    color: var(--hc-bg-primary);
    border-color: var(--color-primary);
  }
  
  .btn-primary:hover {
    background-color: var(--color-primary-hover);
    border-color: var(--color-primary-hover);
    box-shadow: none;
    transform: none;
  }
  
  .btn-secondary {
    background-color: transparent;
    color: var(--hc-text-primary);
    border-color: var(--hc-text-primary);
  }
  
  .btn-secondary:hover {
    background-color: var(--hc-text-primary);
    color: var(--hc-bg-primary);
    border-color: var(--hc-text-primary);
  }
  
  .btn-danger {
    background-color: var(--color-danger);
    color: var(--hc-text-primary);
    border-color: var(--color-danger);
  }
  
  .btn:focus-visible {
    outline: var(--hc-outline-width) solid var(--color-primary);
    outline-offset: 2px;
    box-shadow: none;
  }
  
  /* Form elements */
  .form-input,
  .form-select,
  .form-textarea {
    background-color: var(--hc-bg-primary);
    color: var(--hc-text-primary);
    border: var(--hc-border-width) solid var(--hc-border-primary);
    box-shadow: none;
  }
  
  .form-input:focus,
  .form-select:focus,
  .form-textarea:focus {
    border-color: var(--color-primary);
    outline: var(--hc-outline-width) solid var(--color-primary);
    outline-offset: 2px;
    box-shadow: none;
  }
  
  .form-input::placeholder {
    color: var(--hc-text-secondary);
    opacity: 1;
  }
  
  /* Form validation states */
  .form-input.error,
  .form-select.error,
  .form-textarea.error {
    border-color: var(--color-danger);
    background-color: var(--hc-bg-primary);
  }
  
  .form-input.success,
  .form-select.success,
  .form-textarea.success {
    border-color: var(--color-success);
    background-color: var(--hc-bg-primary);
  }
  
  /* Form messages */
  .form-error {
    background-color: var(--hc-bg-secondary);
    color: var(--color-danger);
    border: var(--hc-border-width) solid var(--color-danger);
    box-shadow: none;
  }
  
  .form-success {
    background-color: var(--hc-bg-secondary);
    color: var(--color-success);
    border: var(--hc-border-width) solid var(--color-success);
    box-shadow: none;
  }
  
  .form-warning {
    background-color: var(--hc-bg-secondary);
    color: var(--color-warning);
    border: var(--hc-border-width) solid var(--color-warning);
    box-shadow: none;
  }
  
  .form-info {
    background-color: var(--hc-bg-secondary);
    color: var(--color-info);
    border: var(--hc-border-width) solid var(--color-info);
    box-shadow: none;
  }
  
  /* Navigation - no container styling */
  
  .navigation__link {
    color: var(--hc-text-primary);
    border: 1px solid transparent;
  }
  
  .navigation__link:hover,
  .navigation__link--active {
    color: var(--hc-bg-primary);
    border-color: var(--color-primary);
  }
  
  .navigation__link:focus-visible {
    outline: var(--hc-outline-width) solid var(--color-primary);
    outline-offset: 2px;
  }
  
  /* Tables */
  table {
    border: var(--hc-border-width) solid var(--hc-border-primary);
  }
  
  th,
  td {
    border: 1px solid var(--hc-border-secondary);
    background-color: var(--hc-bg-secondary);
  }
  
  th {
    background-color: var(--hc-bg-tertiary);
    color: var(--hc-text-primary);
  }
  
  /* Remove decorative elements that may reduce contrast */
  .glow,
  .shadow,
  .gradient,
  [class*="glow"],
  [class*="shadow"],
  [class*="gradient"] {
    box-shadow: none !important;
    background-image: none !important;
    text-shadow: none !important;
  }
  
  /* Status indicators */
  .status-success,
  .text-success {
    color: var(--color-success);
    font-weight: var(--font-weight-bold);
  }
  
  .status-error,
  .text-error {
    color: var(--color-danger);
    font-weight: var(--font-weight-bold);
  }
  
  .status-warning,
  .text-warning {
    color: var(--color-warning);
    font-weight: var(--font-weight-bold);
  }
  
  /* Loading states */
  .loading-spinner {
    border-color: var(--hc-border-primary);
    border-top-color: var(--color-primary);
  }
  
  /* Badges and labels */
  .badge,
  .label {
    border: var(--hc-border-width) solid var(--hc-border-primary);
    background-color: var(--hc-bg-tertiary);
    color: var(--hc-text-primary);
  }
  
  .badge--primary {
    background-color: var(--color-primary);
    color: var(--hc-bg-primary);
    border-color: var(--color-primary);
  }
  
  /* Progress bars */
  .progress-bar {
    background-color: var(--hc-bg-tertiary);
    border: var(--hc-border-width) solid var(--hc-border-primary);
  }
  
  .progress-bar__fill {
    background-color: var(--color-primary);
  }
  
  /* Tooltips */
  .tooltip {
    background-color: var(--hc-bg-primary);
    color: var(--hc-text-primary);
    border: var(--hc-border-width) solid var(--hc-border-primary);
    box-shadow: none;
  }
  
  /* Modals */
  .modal-backdrop {
    background-color: rgba(0, 0, 0, 0.9);
  }
  
  .modal-content {
    background-color: var(--hc-bg-secondary);
    border: var(--hc-border-width) solid var(--hc-border-primary);
    box-shadow: none;
  }
  
  /* Dropdowns */
  .dropdown-menu {
    background-color: var(--hc-bg-secondary);
    border: var(--hc-border-width) solid var(--hc-border-primary);
    box-shadow: none;
  }
  
  .dropdown-item {
    color: var(--hc-text-primary);
    border-bottom: 1px solid var(--hc-border-secondary);
  }
  
  .dropdown-item:hover,
  .dropdown-item:focus {
    background-color: var(--color-primary);
    color: var(--hc-bg-primary);
  }
}

/* ============================================
   FORCED COLORS MODE (Windows High Contrast)
   ============================================ */

@media (forced-colors: active) {
  /* Use system colors in forced colors mode */
  :root {
    /* Override all custom colors with system colors */
    --color-text-primary: CanvasText;
    --color-text-secondary: CanvasText;
    --color-text-tertiary: CanvasText;
    --color-bg-primary: Canvas;
    --color-bg-secondary: Canvas;
    --color-bg-tertiary: Canvas;
    --color-primary: Highlight;
    --color-secondary: Highlight;
    --color-success: Highlight;
    --color-danger: Highlight;
    --color-warning: Highlight;
    --color-info: Highlight;
    --color-border-medium: CanvasText;
    --color-border-strong: CanvasText;
    --color-border-subtle: CanvasText;
  }
  
  /* Force system colors on all elements */
  * {
    color: CanvasText !important;
    background-color: Canvas !important;
    border-color: CanvasText !important;
    forced-color-adjust: none;
  }
  
  /* Interactive elements */
  .btn,
  a,
  button,
  [role="button"],
  input,
  select,
  textarea {
    color: ButtonText !important;
    background-color: ButtonFace !important;
    border-color: ButtonText !important;
  }
  
  .btn:hover,
  .btn:focus,
  a:hover,
  a:focus,
  button:hover,
  button:focus,
  [role="button"]:hover,
  [role="button"]:focus {
    color: HighlightText !important;
    background-color: Highlight !important;
    border-color: Highlight !important;
  }
  
  /* Form elements */
  input,
  textarea,
  select {
    color: FieldText !important;
    background-color: Field !important;
    border-color: FieldText !important;
  }
  
  input:focus,
  textarea:focus,
  select:focus {
    color: HighlightText !important;
    background-color: Highlight !important;
    border-color: Highlight !important;
  }
  
  /* Disabled elements */
  :disabled,
  [aria-disabled="true"] {
    color: GrayText !important;
    background-color: Canvas !important;
    border-color: GrayText !important;
  }
  
  /* Remove all custom shadows, gradients, and effects */
  * {
    box-shadow: none !important;
    text-shadow: none !important;
    background-image: none !important;
    backdrop-filter: none !important;
  }
  
  /* Focus indicators */
  *:focus {
    outline: 2px solid Highlight !important;
    outline-offset: 2px !important;
  }
  
  /* Links */
  a {
    color: LinkText !important;
    background-color: Canvas !important;
  }
  
  a:visited {
    color: VisitedText !important;
  }
  
  a:hover,
  a:focus {
    color: HighlightText !important;
    background-color: Highlight !important;
  }
  
  /* Selected text */
  ::selection {
    color: HighlightText !important;
    background-color: Highlight !important;
  }
  
  /* Tables */
  table,
  th,
  td {
    border-color: CanvasText !important;
    background-color: Canvas !important;
    color: CanvasText !important;
  }
  
  /* Navigation */
  .navigation {
    background-color: Canvas !important;
    border-color: CanvasText !important;
  }
  
  /* Cards and containers */
  .card,
  .modal,
  .dropdown {
    background-color: Canvas !important;
    border-color: CanvasText !important;
    color: CanvasText !important;
  }
}

/* ============================================
   HIGH CONTRAST UTILITY CLASSES
   ============================================ */

/* Manual high contrast toggle class */
.high-contrast {
  /* Apply high contrast styles when this class is added to body */
}

.high-contrast * {
  /* Force high contrast on all elements */
  text-shadow: none !important;
  box-shadow: none !important;
  background-image: none !important;
}

.high-contrast .card,
.high-contrast .btn,
.high-contrast .form-input {
  border-width: 2px !important;
  border-style: solid !important;
}

.high-contrast .btn-primary {
  background-color: var(--color-primary) !important;
  color: var(--color-bg-primary) !important;
  border-color: var(--color-primary) !important;
}

.high-contrast .btn-secondary {
  background-color: transparent !important;
  color: var(--color-text-primary) !important;
  border-color: var(--color-text-primary) !important;
}

.high-contrast *:focus-visible {
  outline-width: 4px !important;
  outline-style: solid !important;
  outline-color: var(--color-primary) !important;
  outline-offset: 2px !important;
}

/* ============================================
   HIGH CONTRAST TESTING UTILITIES
   ============================================ */

/* Development helper class for testing high contrast */
.test-high-contrast {
  filter: contrast(200%) brightness(150%);
}

/* Simulate forced colors mode for testing */
.test-forced-colors * {
  color: black !important;
  background-color: white !important;
  border-color: black !important;
}

.test-forced-colors .btn,
.test-forced-colors a {
  color: blue !important;
  background-color: white !important;
  border-color: blue !important;
}

.test-forced-colors .btn:hover,
.test-forced-colors a:hover {
  color: white !important;
  background-color: blue !important;
  border-color: blue !important;
}

/* ============================================
   PRINT HIGH CONTRAST
   ============================================ */

@media print {
  /* Ensure high contrast in print */
  * {
    background: white !important;
    color: black !important;
    box-shadow: none !important;
    text-shadow: none !important;
  }
  
  .btn,
  .card,
  .form-input {
    border: 2px solid black !important;
  }
  
  a {
    color: black !important;
    text-decoration: underline !important;
  }
  
  /* Show URLs for links in print */
  a[href]::after {
    content: " (" attr(href) ")";
    font-size: 0.8em;
    color: #666;
  }
}

/* ============================================
   ACCESSIBILITY DEBUGGING
   ============================================ */

/* Uncomment for high contrast debugging */
/*
.debug-high-contrast * {
  outline: 1px solid red !important;
}

.debug-high-contrast *:focus {
  outline: 3px solid blue !important;
}

.debug-high-contrast [aria-hidden="true"] {
  background: rgba(255, 0, 0, 0.3) !important;
}
*/